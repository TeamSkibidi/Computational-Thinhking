<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wanderlust • Teal Edition</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0d9488', // Teal 600
                        primaryLight: '#2dd4bf', // Teal 400
                        surface: '#F0FDF4', 
                    },
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'sans-serif'],
                        display: ['Playfair Display', 'serif'],
                    },
                    boxShadow: {
                        'teal-glow': '0 10px 25px -5px rgba(13, 148, 136, 0.4)',
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    
    <!-- FontAwesome & Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Playfair+Display:ital,wght@0,600;0,700;0,800;1,600;1,700;1,800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #F8FAFC; color: #334155; }
        h1, h2, h3 { font-family: 'Playfair Display', serif; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* HERO HEADER */
        .hero-section {
            background: linear-gradient(to bottom, rgba(13, 148, 136, 0.1) 0%, #F8FAFC 100%), 
                        url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            height: 400px;
            position: relative;
        }

        /* CARD STYLES */
        .journal-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            overflow: hidden;
            border: 1px solid #E2E8F0;
        }
        .journal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1);
            border-color: #99f6e4;
        }

        /* TIMELINE */
        .timeline-track {
            position: absolute; left: 28px; top: 20px; bottom: 0;
            width: 2px;
            background-image: linear-gradient(to bottom, #cbd5e1 50%, transparent 50%);
            background-size: 2px 12px;
            background-repeat: repeat-y;
            z-index: 0;
        }
        
        .session-badge {
            background: white;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            border: 1px solid #E2E8F0;
            padding: 0.5rem 1rem;
            border-radius: 99px;
            font-weight: 700;
            font-size: 0.9rem;
            color: #475569;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            z-index: 10;
        }

        /* --- NEW "MODERN CARD" DAY NAVIGATOR STYLES --- */
        .day-tab-card {
            width: 85px;
            height: 95px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            border: 1px solid #E2E8F0;
            color: #64748b;
            box-shadow: 0 4px 10px -2px rgba(0, 0, 0, 0.03);
            position: relative;
            overflow: hidden;
        }

        .day-tab-card:hover {
            transform: translateY(-3px);
            border-color: #99f6e4;
            box-shadow: 0 10px 15px -3px rgba(153, 246, 228, 0.4);
        }

        .day-tab-card.active {
            background: #0d9488; /* Teal 600 */
            border-color: #0d9488;
            color: white;
            box-shadow: 0 8px 20px -4px rgba(13, 148, 136, 0.4);
            transform: scale(1.05);
        }

        .day-tab-label {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 4px;
            opacity: 0.8;
        }

        .day-tab-date {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1;
        }
        
        /* Active indicator dot inside card */
        .day-tab-card::after {
            content: '';
            position: absolute;
            bottom: 8px;
            width: 4px;
            height: 4px;
            background: currentColor;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .day-tab-card.active::after { opacity: 1; }
        /* -------------------------------------------------- */

        /* DRAWER & DROPDOWN */
        .drawer-overlay {
            position: fixed; inset: 0; background: rgba(15, 23, 42, 0.2);
            backdrop-filter: blur(4px); z-index: 40; opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .drawer-overlay.open { opacity: 1; pointer-events: auto; }
        
        .config-panel {
            position: fixed; top: 16px; right: 16px; bottom: 16px; width: 400px;
            background: white; border-radius: 24px;
            box-shadow: -10px 0 40px rgba(0,0,0,0.1);
            transform: translateX(120%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 50; display: flex; flex-col;
        }
        .config-panel.open { transform: translateX(0); }

        .tags-dropdown-menu {
            transform-origin: top; transition: all 0.2s; transform: scaleY(0); opacity: 0; pointer-events: none;
        }
        .tags-dropdown-menu.open { transform: scaleY(1); opacity: 1; pointer-events: auto; }
        .tags-trigger.open i { transform: rotate(180deg); }

        /* TAGS */
        .travel-tag {
            border: 1px solid #E2E8F0; border-radius: 12px; padding: 8px 16px;
            cursor: pointer; transition: all 0.2s; font-size: 0.9rem;
            display: flex; align-items: center; gap: 6px; user-select: none;
        }
        .travel-tag:hover { background: #f0fdfa; border-color: #99f6e4; }
        .travel-tag.selected { background: #ccfbf1; border-color: #14b8a6; color: #0f766e; font-weight: 600; }

        /* Animation */
        @keyframes floatUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-enter { animation: floatUp 0.5s ease-out forwards; opacity: 0; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- HERO SECTION -->
    <header class="hero-section flex items-end pb-10 px-6 lg:px-12">
        <div class="max-w-5xl w-full mx-auto relative z-10 flex flex-col md:flex-row justify-between items-end gap-6">
            <div class="animate-enter" style="animation-delay: 0.1s;">
                <div class="bg-white/80 backdrop-blur-md px-4 py-2 rounded-full inline-flex items-center gap-2 text-sm font-bold text-teal-700 mb-4 shadow-sm border border-white/50">
                    <i class="fa-solid fa-compass"></i>
                    <span>Travel Planner AI</span>
                </div>
                <h1 class="text-5xl md:text-7xl font-bold text-slate-800 leading-tight drop-shadow-sm" id="heroTitle">
                    Khám Phá<br><span class="text-teal-600">Đà Nẵng</span>
                </h1>
            </div>
            
            <div class="flex items-center gap-4 animate-enter" style="animation-delay: 0.2s;">
                <div class="bg-white/90 backdrop-blur-xl p-4 rounded-2xl shadow-lg border border-white/50 flex flex-col items-end min-w-[140px]">
                    <span class="text-xs font-bold text-slate-400 uppercase tracking-wide">Tổng chi phí</span>
                    <span class="text-2xl font-bold text-teal-600" id="heroCost">0 đ</span>
                </div>
                <button onclick="toggleConfig(true)" class="bg-teal-600 hover:bg-teal-700 text-white w-16 h-16 rounded-2xl shadow-teal-glow flex items-center justify-center text-2xl transition-all hover:scale-105 active:scale-95">
                    <i class="fa-solid fa-sliders"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="flex-1 max-w-5xl mx-auto w-full px-6 -mt-6 relative z-20 pb-20">
        
        <!-- Day Navigator (New Modern Card Style) -->
        <div class="overflow-x-auto pb-8 hide-scrollbar">
            <div class="flex gap-4 px-1" id="dayNavigator">
                <!-- JS Generated Cards -->
            </div>
        </div>

        <!-- Timeline Container -->
        <div class="mt-2 relative" id="timelineContainer">
            <div class="timeline-track"></div>
            <div class="text-center py-20 opacity-50">
                <i class="fa-solid fa-map-location-dot text-6xl text-slate-300 mb-4"></i>
                <p>Đang tải dữ liệu chuyến đi...</p>
            </div>
        </div>
    </main>

    <!-- CONFIGURATION DRAWER -->
    <div class="drawer-overlay" id="drawerBackdrop" onclick="toggleConfig(false)"></div>
    <div class="config-panel flex flex-col overflow-hidden" id="configPanel">
        <div class="p-6 border-b border-slate-100 flex justify-between items-center bg-white">
            <h2 class="text-xl font-bold text-slate-800">Thiết kế lịch trình</h2>
            <button onclick="toggleConfig(false)" class="w-8 h-8 rounded-full bg-slate-50 hover:bg-slate-100 flex items-center justify-center text-slate-500 transition">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        
        <div class="flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar">
            <div class="space-y-5">
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2">Bạn muốn đi đâu?</label>
                    <div class="relative group">
                        <i class="fa-solid fa-location-arrow absolute left-4 top-3.5 text-slate-400 group-hover:text-teal-500 transition-colors"></i>
                        <input type="text" id="inputCity" value="Đà Nẵng" class="w-full pl-11 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-teal-100 focus:border-teal-500 outline-none font-medium transition-all text-slate-700">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Ngày đi</label>
                        <input type="date" id="inputStartDate" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-teal-100 focus:border-teal-500 outline-none font-medium text-slate-600">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Số ngày</label>
                        <input type="number" id="inputNumDays" value="4" min="1" max="10" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-teal-100 focus:border-teal-500 outline-none font-medium text-slate-600">
                    </div>
                </div>
            </div>

            <div class="space-y-3 relative">
                <label class="block text-sm font-bold text-slate-700">Phong cách du lịch</label>
                <div id="tagsTrigger" onclick="toggleTagsDropdown(event)" 
                     class="tags-trigger w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl flex justify-between items-center cursor-pointer hover:border-teal-300 hover:bg-white transition-all select-none">
                    <span id="tagsSelectedText" class="text-slate-500 font-medium truncate pr-2">Chọn phong cách...</span>
                    <i class="fa-solid fa-chevron-down text-slate-400 text-sm transition-transform duration-300"></i>
                </div>
                <div id="tagsDropdown" class="tags-dropdown-menu absolute top-full left-0 right-0 mt-2 bg-white border border-slate-100 rounded-xl shadow-xl z-50 p-4 max-h-64 overflow-y-auto custom-scrollbar">
                    <div class="flex flex-wrap gap-2" id="tagsContainer"></div>
                </div>
            </div>

            <div class="space-y-3">
                <label class="block text-sm font-bold text-slate-700">Khung giờ hoạt động</label>
                <div class="space-y-2" id="blocksConfigContainer"></div>
            </div>
        </div>

        <div class="p-6 border-t border-slate-100 bg-slate-50">
            <button id="btnGenerate" class="w-full py-4 bg-teal-600 hover:bg-teal-700 text-white font-bold rounded-xl shadow-lg shadow-teal-200 transition-all active:scale-[0.98] flex items-center justify-center gap-2 text-lg">
                <i class="fa-solid fa-wand-magic-sparkles"></i> Tạo Lịch Trình Mới
            </button>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA & CONFIG ---
        const TAGS = [
            { id: "nature", label: "Thiên nhiên", icon: "fa-leaf" },
            { id: "food", label: "Ăn uống", icon: "fa-utensils" },
            { id: "history", label: "Lịch sử", icon: "fa-landmark" },
            { id: "beach", label: "Biển đảo", icon: "fa-umbrella-beach" },
            { id: "photo", label: "Sống ảo", icon: "fa-camera" },
            { id: "relax", label: "Nghỉ dưỡng", icon: "fa-spa" },
            { id: "shopping", label: "Mua sắm", icon: "fa-bag-shopping" },
            { id: "adventure", label: "Khám phá", icon: "fa-person-hiking" }
        ];

        const BLOCKS = [
            { id: 'morning', label: 'Sáng', start: '08:00', end: '11:30', icon: 'fa-sun', color: 'text-amber-500' },
            { id: 'lunch', label: 'Trưa', start: '11:30', end: '13:00', icon: 'fa-utensils', color: 'text-orange-500' },
            { id: 'afternoon', label: 'Chiều', start: '13:30', end: '17:30', icon: 'fa-cloud-sun', color: 'text-sky-500' },
            { id: 'dinner', label: 'Tối', start: '18:00', end: '19:30', icon: 'fa-moon', color: 'text-indigo-500' },
            { id: 'evening', label: 'Đêm', start: '20:00', end: '22:00', icon: 'fa-martini-glass', color: 'text-purple-500' }
        ];

        let state = {
            city: "Đà Nẵng",
            tags: new Set(['nature', 'food']),
            data: [],
            activeDay: 0,
            isTagsDropdownOpen: false
        };

        const els = {
            drawer: document.getElementById('configPanel'),
            backdrop: document.getElementById('drawerBackdrop'),
            tags: document.getElementById('tagsContainer'),
            tagsTrigger: document.getElementById('tagsTrigger'),
            tagsDropdown: document.getElementById('tagsDropdown'),
            tagsText: document.getElementById('tagsSelectedText'),
            blocks: document.getElementById('blocksConfigContainer'),
            timeline: document.getElementById('timelineContainer'),
            nav: document.getElementById('dayNavigator'),
            heroTitle: document.getElementById('heroTitle'),
            heroCost: document.getElementById('heroCost')
        };

        // --- CORE FUNCTIONS ---
        function toggleConfig(open) {
            if(open) {
                els.backdrop.classList.add('open');
                els.drawer.classList.add('open');
            } else {
                els.backdrop.classList.remove('open');
                els.drawer.classList.remove('open');
                closeTagsDropdown();
            }
        }

        // Tags Dropdown
        function toggleTagsDropdown(e) {
            if (e) e.stopPropagation();
            state.isTagsDropdownOpen = !state.isTagsDropdownOpen;
            updateTagsDropdownUI();
        }
        function closeTagsDropdown() {
            state.isTagsDropdownOpen = false;
            updateTagsDropdownUI();
        }
        function updateTagsDropdownUI() {
            if (state.isTagsDropdownOpen) {
                els.tagsDropdown.classList.add('open');
                els.tagsTrigger.classList.add('open');
                els.tagsTrigger.classList.add('border-teal-300', 'ring-2', 'ring-teal-100');
            } else {
                els.tagsDropdown.classList.remove('open');
                els.tagsTrigger.classList.remove('open');
                els.tagsTrigger.classList.remove('border-teal-300', 'ring-2', 'ring-teal-100');
            }
        }
        document.addEventListener('click', (e) => {
            if (!els.tagsTrigger.contains(e.target) && !els.tagsDropdown.contains(e.target)) {
                closeTagsDropdown();
            }
        });

        function toggleTag(id) {
            if(state.tags.has(id)) state.tags.delete(id);
            else state.tags.add(id);
            renderTags();
            updateSelectedTagsText();
        }

        function updateSelectedTagsText() {
            if (state.tags.size === 0) {
                els.tagsText.textContent = "Chọn phong cách...";
                els.tagsText.className = "text-slate-400 font-medium truncate pr-2";
            } else {
                const labels = Array.from(state.tags).map(id => TAGS.find(t => t.id === id)?.label).filter(Boolean);
                els.tagsText.textContent = labels.join(', ');
                els.tagsText.className = "text-teal-700 font-bold truncate pr-2";
            }
        }

        function renderTags() {
            els.tags.innerHTML = TAGS.map(t => `
                <div onclick="toggleTag('${t.id}')" 
                    class="travel-tag ${state.tags.has(t.id) ? 'selected' : 'bg-slate-50 text-slate-600'}">
                    <i class="fa-solid ${t.icon}"></i> ${t.label}
                </div>
            `).join('');
        }

        function renderBlockConfigs() {
            els.blocks.innerHTML = BLOCKS.map(b => `
                <div class="flex items-center gap-3 p-3 rounded-xl border border-slate-100 bg-white hover:border-teal-100 transition-colors group">
                    <div class="w-8 h-8 rounded-lg bg-slate-50 group-hover:bg-teal-50 flex items-center justify-center ${b.color} transition-colors">
                        <i class="fa-solid ${b.icon}"></i>
                    </div>
                    <span class="flex-1 font-medium text-slate-700">${b.label}</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" checked class="sr-only peer">
                        <div class="w-9 h-5 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-teal-500"></div>
                    </label>
                </div>
            `).join('');
        }

        async function handleGenerate() {
            const btn = document.getElementById('btnGenerate');
            const original = btn.innerHTML;
            btn.innerHTML = `<i class="fa-solid fa-sync fa-spin"></i> Đang xử lý...`;
            btn.disabled = true;

            state.city = document.getElementById('inputCity').value;
            const days = parseInt(document.getElementById('inputNumDays').value);

            await new Promise(r => setTimeout(r, 600));
            state.data = generateMockData(state.city, days);
            state.activeDay = 0;

            updateHeroView();
            renderDayNav();
            renderTimeline();
            toggleConfig(false);

            btn.innerHTML = original;
            btn.disabled = false;
        }

        function updateHeroView() {
            els.heroTitle.innerHTML = `Khám Phá<br><span class="text-teal-600">${state.city}</span>`;
            const total = state.data.reduce((acc, d) => acc + d.cost, 0);
            els.heroCost.textContent = total.toLocaleString('vi-VN') + ' đ';
        }

        // --- NEW RENDERER FOR DAY NAVIGATOR (Modern Card Style) ---
        function renderDayNav() {
            els.nav.innerHTML = state.data.map((day, idx) => `
                <div onclick="switchDay(${idx})" 
                    class="day-tab-card ${idx === state.activeDay ? 'active' : ''} shrink-0">
                    <div class="day-tab-label">Ngày ${idx+1}</div>
                    <div class="day-tab-date">${day.dateShort}</div>
                </div>
            `).join('');
        }

        window.switchDay = (idx) => {
            state.activeDay = idx;
            renderDayNav();
            renderTimeline();
        }

        function renderTimeline() {
            const dayData = state.data[state.activeDay];
            let html = '<div class="timeline-track"></div>';
            let delay = 0;

            BLOCKS.forEach(block => {
                const items = dayData.blocks[block.id];
                if(items && items.length) {
                    html += `
                        <div class="relative pl-16 mb-6 animate-enter" style="animation-delay: ${delay}ms">
                            <div class="absolute left-0 top-1/2 -translate-y-1/2 w-[58px] flex justify-center z-10">
                                <div class="w-3 h-3 rounded-full bg-slate-300 ring-4 ring-slate-100"></div>
                            </div>
                            <div class="session-badge group hover:border-teal-200 transition-colors">
                                <i class="fa-solid ${block.icon} ${block.color}"></i> ${block.label}
                            </div>
                        </div>
                    `;
                    delay += 50;

                    items.forEach(item => {
                        if(item.travel > 0) {
                            html += `
                                <div class="relative pl-16 mb-4 animate-enter" style="animation-delay: ${delay}ms">
                                    <div class="inline-flex items-center gap-2 text-xs font-bold text-slate-400 bg-white px-3 py-1 rounded-full border border-slate-100 shadow-sm">
                                        <i class="fa-solid fa-person-walking"></i> ${item.travel} phút di chuyển
                                    </div>
                                </div>
                            `;
                            delay += 50;
                        }

                        html += `
                            <div class="relative pl-16 mb-10 animate-enter group" style="animation-delay: ${delay}ms">
                                <div class="absolute left-0 top-8 w-[58px] flex justify-center z-10">
                                    <div class="w-4 h-4 rounded-full bg-teal-500 ring-4 ring-white shadow-md group-hover:scale-125 transition-transform"></div>
                                </div>
                                
                                <div class="journal-card flex flex-col md:flex-row cursor-pointer">
                                    <div class="w-full md:w-1/3 h-48 md:h-auto relative overflow-hidden">
                                        <img src="${item.img}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                                        <div class="absolute top-3 left-3 bg-black/50 backdrop-blur-sm text-white text-xs font-bold px-2 py-1 rounded-md">
                                            ${item.time}
                                        </div>
                                    </div>
                                    <div class="p-5 md:w-2/3 flex flex-col justify-between">
                                        <div>
                                            <h3 class="text-xl font-bold text-slate-800 mb-1 font-display group-hover:text-teal-600 transition-colors">${item.name}</h3>
                                            <p class="text-slate-500 text-sm line-clamp-2 leading-relaxed mb-4">
                                                Một địa điểm thú vị để khám phá văn hóa và ẩm thực địa phương. Đừng quên mang theo máy ảnh!
                                            </p>
                                        </div>
                                        <div class="flex items-center gap-6 pt-4 border-t border-slate-50">
                                            <div class="flex items-center gap-2 text-sm text-slate-500 font-medium">
                                                <i class="fa-regular fa-clock text-teal-400"></i> ${item.dwell}p
                                            </div>
                                            <div class="flex items-center gap-2 text-sm text-emerald-600 font-bold">
                                                <i class="fa-solid fa-ticket"></i> ${item.price ? item.price.toLocaleString() + 'đ' : 'Miễn phí'}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        delay += 100;
                    });
                }
            });
            els.timeline.innerHTML = html;
        }

        // --- MOCK DATA ---
        function generateMockData(city, days) {
            const places = [
                { name: 'Cầu Rồng', price: 0, img: 'https://images.unsplash.com/photo-1565672906935-643594e97262?auto=format&fit=crop&w=500&q=80' },
                { name: 'Bà Nà Hills', price: 850000, img: 'https://images.unsplash.com/photo-1575883651816-04287c880628?auto=format&fit=crop&w=500&q=80' },
                { name: 'Phố Cổ Hội An', price: 120000, img: 'https://images.unsplash.com/photo-1545628172-56230f898314?auto=format&fit=crop&w=500&q=80' },
                { name: 'Biển Mỹ Khê', price: 0, img: 'https://images.unsplash.com/photo-1569300551066-50e5025d5390?auto=format&fit=crop&w=500&q=80' },
                { name: 'Chùa Linh Ứng', price: 0, img: 'https://images.unsplash.com/photo-1629215354897-402741490225?auto=format&fit=crop&w=500&q=80' },
                { name: 'Mì Quảng Ếch', price: 55000, img: 'https://images.unsplash.com/photo-1632556754857-e6ae826134b2?auto=format&fit=crop&w=500&q=80' },
                { name: 'Bánh Tráng Cuốn', price: 150000, img: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=500&q=80' },
                { name: 'Cà phê Dừa', price: 45000, img: 'https://images.unsplash.com/photo-1514432324607-a09d9b4aefdd?auto=format&fit=crop&w=500&q=80' }
            ];

            const today = new Date();
            
            return Array.from({length: days}, (_, i) => {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                const dateShort = `${date.getDate()}/${date.getMonth()+1}`;
                const dayCost = Math.floor(Math.random() * 1000000);
                const blocks = {};

                BLOCKS.forEach(b => {
                    const count = (b.id === 'lunch' || b.id === 'dinner') ? 1 : Math.floor(Math.random() * 2) + 1;
                    blocks[b.id] = [];
                    for(let k=0; k<count; k++) {
                        const p = places[Math.floor(Math.random() * places.length)];
                        blocks[b.id].push({
                            name: p.name,
                            time: b.start,
                            dwell: 90,
                            price: p.price,
                            img: p.img,
                            travel: k===0 ? Math.floor(Math.random() * 20 + 10) : 0
                        });
                    }
                });

                return {
                    dateShort,
                    cost: dayCost,
                    blocks
                };
            });
        }

        function init() {
            document.getElementById('inputStartDate').valueAsDate = new Date();
            renderTags();
            renderBlockConfigs();
            updateSelectedTagsText();
            handleGenerate();
        }
        
        init();
    </script>
</body>
</html>